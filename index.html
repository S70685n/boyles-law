<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gas Law Calculator</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f0f0f0;
    margin: 0;
    padding: 20px;
}
label { font-weight: bold; }
input, select {
    width: 100%;
    padding: 14px;
    margin: 8px 0 14px 0;
    font-size: 18px;
}
button {
    width: 100%;
    padding: 14px;
    font-size: 18px;
    background: red;
    color: black;
    border: none;
    border-radius: 6px;
}
.result {
    margin-top: 15px;
    font-size: 20px;
    font-weight: bold;
    text-align: center;
}
</style>
</head>

<body>

<h2 style="text-align:center;">Gas Law Calculator (Cylinders)</h2>

<label>Gas Law</label>
<select id="gasLaw" onchange="toggleGasLaw()">
    <option value="boyle">Boyleâ€™s Law (Constant Temp)</option>
    <option value="ideal">Ideal Gas Law</option>
</select>

<label>Pressure Unit</label>
<select id="pressureUnit">
    <option value="psi">psi</option>
    <option value="bar">bar</option>
</select>

<label>Cylinder Circumference</label>
<select id="C">
    <option value="2">2 inches</option>
    <option value="2.5">2.5 inches</option>
</select>

<div id="radiusDisplay" style="font-weight:bold;"></div>

<label>Initial Pressure (P1)</label>
<input id="P1">

<label>Final Pressure (P2)</label>
<input id="P2">

<label>Initial Height</label>
<input id="H1">
<select id="H1Unit">
    <option value="in">inches</option>
    <option value="mm">millimeters</option>
</select>

<label>Final Height</label>
<input id="H2">
<select id="H2Unit">
    <option value="in">inches</option>
    <option value="mm">millimeters</option>
</select>

<div id="idealInputs" style="display:none;">
<label>Temperature</label>
<input id="temp">
<select id="tempUnit">
    <option value="K">Kelvin</option>
    <option value="C">Celsius</option>
    <option value="F">Fahrenheit</option>
</select>

<label>Moles (n)</label>
<input id="moles">
</div>

<button onclick="calculate()">Calculate</button>

<div id="result" class="result"></div>

<script>
const R = 8.314;

function toggleGasLaw(){
    idealInputs.style.display = gasLaw.value === "ideal" ? "block" : "none";
}

function heightToMeters(v,u){ return u==="in" ? v*0.0254 : v/1000; }
function pressureToPa(v,u){ return u==="psi" ? v*6894.76 : v*100000; }
function paToPressure(v,u){ return u==="psi" ? v/6894.76 : v/100000; }
function tempToK(v,u){
    if(u==="C") return v+273.15;
    if(u==="F") return (v-32)*5/9+273.15;
    return v;
}
function kToTemp(v,u){
    if(u==="C") return v-273.15;
    if(u==="F") return (v-273.15)*9/5+32;
    return v;
}

function calculate(){
    let P1v=parseFloat(P1.value);
    let P2v=parseFloat(P2.value);
    let H1v=parseFloat(H1.value);
    let H2v=parseFloat(H2.value);

    let C_in=parseFloat(C.value);
    let r_m=(C_in/(2*Math.PI))*0.0254;
    radiusDisplay.innerText=`Derived Radius = ${(r_m/0.0254).toFixed(3)} in`;

    if(gasLaw.value==="boyle"){
        let blanks=[P1v,P2v,H1v,H2v].filter(v=>isNaN(v)).length;
        if(blanks!==1){
            result.innerText="Leave exactly ONE field blank";
            return;
        }
        if(isNaN(P1v))
            result.innerText=`P1 = ${(P2v*H2v/H1v).toFixed(2)} ${pressureUnit.value}`;
        else if(isNaN(P2v))
            result.innerText=`P2 = ${(P1v*H1v/H2v).toFixed(2)} ${pressureUnit.value}`;
        else if(isNaN(H1v))
            result.innerText=`H1 = ${(P2v*H2v/P1v).toFixed(2)} ${H1Unit.value}`;
        else
            result.innerText=`H2 = ${(P1v*H1v/P2v).toFixed(2)} ${H2Unit.value}`;
        return;
    }

    // Ideal Gas Law
    let Tv=parseFloat(temp.value);
    let nv=parseFloat(moles.value);
    let blanks=[P1v,H1v,Tv,nv].filter(v=>isNaN(v)).length;
    if(blanks!==1){
        result.innerText="Leave exactly ONE Ideal Gas variable blank";
        return;
    }

    let h_m=heightToMeters(H1v,H1Unit.value);
    let V=Math.PI*r_m*r_m*h_m;
    let P_pa=isNaN(P1v)?null:pressureToPa(P1v,pressureUnit.value);
    let T_k=isNaN(Tv)?null:tempToK(Tv,tempUnit.value);

    if(isNaN(P1v)){
        let Pcalc=(nv*R*T_k)/V;
        result.innerText=`Pressure = ${paToPressure(Pcalc,pressureUnit.value).toFixed(2)} ${pressureUnit.value}`;
    }
    else if(isNaN(H1v)){
        let Vcalc=(nv*R*T_k)/P_pa;
        let hcalc=Vcalc/(Math.PI*r_m*r_m);
        result.innerText=`Height = ${(hcalc/0.0254).toFixed(2)} in`;
    }
    else if(isNaN(Tv)){
        let Tcalc=(P_pa*V)/(nv*R);
        result.innerText=`Temperature = ${kToTemp(Tcalc,tempUnit.value).toFixed(2)} ${tempUnit.value}`;
    }
    else{
        let ncalc=(P_pa*V)/(R*T_k);
        result.innerText=`Moles = ${ncalc.toFixed(4)}`;
    }
}
</script>

</body>
</html>
